<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniQuiz - ×›× ×™×¡×”</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap" rel="stylesheet">
    <style>body { font-family: 'Rubik', sans-serif; }</style>
</head>
<body class="bg-blue-50 min-h-screen flex flex-col items-center justify-center p-4">

    <div id="login-screen" class="w-full max-w-md bg-white p-8 rounded-2xl shadow-xl text-center">
        <h1 class="text-3xl font-bold mb-6 text-blue-800">UniQuiz</h1>
        <input type="text" id="username" class="w-full p-4 border-2 border-gray-200 rounded-xl mb-4 text-right text-lg focus:border-blue-500 outline-none" placeholder="×”×©× ×©×œ×š...">
        <button onclick="joinGame()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold text-xl shadow-lg transition transform active:scale-95">×”×›× ×¡ ×œ××©×—×§ ğŸš€</button>
    </div>

    <div id="waiting-screen" class="hidden text-center">
        <div class="animate-bounce text-6xl mb-4">â³</div>
        <h2 class="text-2xl font-bold text-gray-700 animate-pulse">×××ª×™×Ÿ ×œ××¨×¦×” ×©×™×¤×¢×™×œ ××ª ×”×©××œ×”...</h2>
    </div>

    <div id="game-screen" class="hidden w-full max-w-lg">
        <h2 id="question-text" class="text-2xl font-bold mb-8 text-center bg-white p-6 rounded-2xl shadow-md text-gray-800 border-b-4 border-blue-100"></h2>
        <div id="options-container" class="grid grid-cols-1 gap-4"></div>
    </div>

    <div id="result-screen" class="hidden text-center w-full max-w-md bg-white p-8 rounded-2xl shadow-xl">
        <div id="result-icon" class="text-6xl mb-4"></div>
        <h2 id="result-msg" class="text-3xl font-bold mb-2"></h2>
        <p class="text-gray-500 text-lg">×”× ×™×§×•×“ ×©×œ×š:</p>
        <p class="text-4xl font-black text-blue-600" id="score">0</p>
    </div>

    <script>
        const socket = io();
        let myName = "";

        function joinGame() {
            const input = document.getElementById('username');
            if (input.value.trim()) {
                myName = input.value;
                socket.emit('join_game', myName);
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('waiting-screen').classList.remove('hidden');
            }
        }

        socket.on('question_start', (q) => {
            document.getElementById('waiting-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            document.getElementById('question-text').innerText = q.text;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            // ×¦×‘×¢×™× ×œ×›×¤×ª×•×¨×™× (×›××• ×‘×§×”×•×˜)
            const colors = ['bg-red-500', 'bg-blue-500', 'bg-yellow-500', 'bg-green-500'];
            
            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                const colorClass = colors[index % colors.length];
                btn.className = `${colorClass} text-white p-6 rounded-xl shadow-md hover:opacity-90 transition font-bold text-xl text-right`;
                btn.innerText = opt;
                btn.onclick = () => {
                    socket.emit('submit_answer', { answerIndex: index });
                    document.getElementById('game-screen').classList.add('hidden');
                    document.getElementById('waiting-screen').classList.remove('hidden');
                    const waitTitle = document.getElementById('waiting-screen').querySelector('h2');
                    waitTitle.innerText = "×ª×©×•×‘×” × ×©×œ×—×”! ×××ª×™×Ÿ ×œ×ª×•×¦××•×ª...";
                };
                container.appendChild(btn);
            });
        });

        socket.on('round_end', (data) => {
            document.getElementById('waiting-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            const msg = document.getElementById('result-msg');
            const score = document.getElementById('score');
            const icon = document.getElementById('result-icon');
            
            if (data.correct) {
                msg.innerText = "× ×›×•×Ÿ ×××•×“!";
                msg.className = "text-3xl font-bold mb-2 text-green-600";
                icon.innerText = "ğŸ†";
            } else {
                msg.innerText = "×œ× × ×•×¨×...";
                msg.className = "text-3xl font-bold mb-2 text-red-600";
                icon.innerText = "âŒ";
            }
            score.innerText = data.score;
        });
    </script>
</body>
</html>
